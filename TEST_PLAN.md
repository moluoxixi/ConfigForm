# Playground 测试计划

## 测试矩阵：48 场景 × 3 模式（编辑态/阅读态/禁用态）

### 已修复的核心库问题（packages/core）
1. `Field.setValue()` 现在会清除验证错误
2. `Field.setValue()` 现在会调用 `form.notifyValuesChange()` 和 `form.notifyFieldValueChange()`
3. `Form.notifyValuesChange/notifyFieldValueChange` 改为 public
4. `FormField`（React + Vue）创建字段时继承 `form.pattern`
5. `@ant-design/icons` 依赖已添加到 playground-react
6. 所有 field 模式示例已添加重置按钮

### 开发服务器
- React: http://localhost:3002 (playground-react, `pnpm dev`)
- Vue: http://localhost:3001 (playground-vue, `pnpm dev`)

---

## Vue antd-vue 测试（优先）

### 基础场景
- [x] Vue-基础场景-1.基础表单-编辑态: 填写全部字段(Input/Password/Select/Radio/Switch/DatePicker/Textarea)、必填校验、提交、重置
- [x] Vue-基础场景-1.基础表单-阅读态: 字段只读不可编辑、提交重置按钮隐藏
- [x] Vue-基础场景-1.基础表单-禁用态: 字段灰色不可操作、提交重置按钮隐藏
- [x] Vue-基础场景-2.表单布局-编辑态: 切换4种布局(水平/垂直/行内/栅格2列)、布局正确性、labelWidth生效
- [x] Vue-基础场景-2.表单布局-阅读态+禁用态: 布局保持一致、按钮隐藏
- [x] Vue-基础场景-3.必填与格式验证-编辑态: 空提交触发必填错误、邮箱/手机/URL/正则格式校验、正确值提交成功
- [x] Vue-基础场景-3.必填与格式验证-阅读态+禁用态: 无校验触发
- [x] Vue-基础场景-4.默认值-编辑态: 静态默认值渲染、动态计算默认值联动(数量×单价=总价)、重置恢复默认值
- [x] Vue-基础场景-4.默认值-阅读态+禁用态: 默认值正常显示

### 联动场景
- [x] Vue-联动场景-5.显隐联动-编辑态: 切换个人/企业→字段显隐、开关控制多字段、嵌套A→B→C显隐、提交排除隐藏字段
- [x] Vue-联动场景-5.显隐联动-阅读态+禁用态: 联动状态保持
- [x] Vue-联动场景-6.值联动-编辑态: 姓名拼接、大写转换、国家→区号/货币映射、省市区聚合
- [x] Vue-联动场景-6.值联动-阅读态+禁用态: 计算值正确显示
- [x] Vue-联动场景-7.属性联动-编辑态: 开关控制disabled、联系方式类型切换placeholder/required、产品类型切换step/单位
- [x] Vue-联动场景-7.属性联动-阅读态+禁用态: 属性状态保持
- [x] Vue-联动场景-8.级联选择-编辑态: 省→市→区三级联动、选择后下级清空重新加载、多级分类联动
- [x] Vue-联动场景-8.级联选择-阅读态+禁用态: 已选值显示（注：级联下级值在模式切换后可能丢失，与:key重建有关）
- [x] Vue-联动场景-9.计算字段-编辑态: 修改单价/数量→总价自动计算(50×5=250)、折扣计算(450)、分数总和/平均分(253/84.33)、条件计税(115.04)
- [x] Vue-联动场景-9.计算字段-阅读态+禁用态: 计算结果正确显示
- [x] Vue-联动场景-10.条件必填-编辑态: 开关→发票字段必填、金额阈值→审批人必填、选其他→原因必填、海外+>3天→保险必填
- [x] Vue-联动场景-10.条件必填-阅读态+禁用态: 必填标记正确

### 验证场景
- [x] Vue-验证场景-11.自定义验证-编辑态: 车牌正则、手机号函数校验、密码多规则stopOnFirst、IP验证
- [x] Vue-验证场景-11.自定义验证-阅读态+禁用态: 无错误提示
- [x] Vue-验证场景-12.异步验证-编辑态: 输入admin触发用户名已注册、邮箱异步校验、邀请码校验
- [x] Vue-验证场景-12.异步验证-阅读态+禁用态: 不触发异步校验
- [x] Vue-验证场景-13.跨字段验证-编辑态: 密码不一致提示、比例总和=100%、超预算
- [x] Vue-验证场景-13.跨字段验证-阅读态+禁用态: 无交叉验证

### 复杂数据
- [x] Vue-复杂数据-14.嵌套对象-编辑态: 填写profile.name/contact.phone等嵌套路径、提交嵌套结构正确（注：嵌套内联动theme→customColor未生效，联动引擎路径匹配问题待查）
- [x] Vue-复杂数据-14.嵌套对象-阅读态+禁用态: 嵌套值显示
- [x] Vue-复杂数据-15.数组字段-编辑态: 填写/添加/删除/排序/提交均正常（修复collectSubmitValues响应式引用泄漏+FormField unmount清理）
- [x] Vue-复杂数据-15.数组字段-阅读态+禁用态: 字段只读/禁用、操作按钮隐藏
- [x] Vue-复杂数据-16.可编辑表格-编辑态: 行内编辑/计算联动/添加删除行/提交均正常
- [x] Vue-复杂数据-16.可编辑表格-阅读态+禁用态: 纯文本展示/禁用输入框，操作列隐藏
- [x] Vue-复杂数据-17.对象数组嵌套-编辑态: 联系人+嵌套电话数组增删/提交嵌套JSON正确
- [x] Vue-复杂数据-17.对象数组嵌套-阅读态+禁用态: 纯文本展示/禁用输入框，操作按钮隐藏

### 数据源
- [x] Vue-数据源-18.异步选项-编辑态: 切换蔬菜→品种异步加载白菜/胡萝卜、选择+提交+重置均正确
- [x] Vue-数据源-18.异步选项-阅读态+禁用态: 纯文本/disabled展示，提交重置按钮隐藏
- [x] Vue-数据源-19.依赖数据源-编辑态: Apple→iPhone15→256GB三级联动+年级→1班、提交+重置正确
- [x] Vue-数据源-19.依赖数据源-阅读态+禁用态: 纯文本/disabled，提交重置隐藏
- [x] Vue-数据源-20.分页搜索-编辑态: 搜索"技术"过滤正确、选择user-5提交+重置正确
- [x] Vue-数据源-20.分页搜索-阅读态+禁用态: disabled/纯文本，提交重置隐藏

### 布局分组
- [x] Vue-布局分组-21.分步表单-编辑态: 空表单验证拦截→填写Step1→Step2→预览→提交+重置正确（修复fieldProps传递）
- [x] Vue-布局分组-21.分步表单-阅读态+禁用态: 步骤可导航、提交重置隐藏
- [x] Vue-布局分组-22.标签页分组-编辑态: 3Tab切换数据保留、提交包含全部Tab数据、重置正确（重写为Field模式+ATabs）
- [x] Vue-布局分组-22.标签页分组-阅读态+禁用态: Tab切换正常、纯文本/disabled
- [x] Vue-布局分组-23.折叠面板-编辑态: 4面板展开折叠、跨面板填写提交正确、重置正确（重写为Field模式+ACollapse）
- [x] Vue-布局分组-23.折叠面板-阅读态+禁用态: 面板正常、纯文本/disabled
- [x] Vue-布局分组-24.卡片分组-编辑态: 3卡片填写+密码验证拦截+跨卡片提交+重置（重写为Field模式+ACard）
- [x] Vue-布局分组-24.卡片分组-阅读态+禁用态: 卡片正常、纯文本/disabled、密码显示******

### 动态表单
- [ ] Vue-动态表单-25.动态增删字段-编辑态: 添加文本/数字/选择字段、删除动态字段、动态字段参与提交
- [ ] Vue-动态表单-25.动态增删字段-阅读态+禁用态: 动态字段只读、添加面板隐藏
- [ ] Vue-动态表单-26.动态Schema-编辑态: 切换个人/企业/学生→字段数变化、mergeSchema、提交
- [ ] Vue-动态表单-26.动态Schema-阅读态+禁用态: 场景切换正常
- [ ] Vue-动态表单-27.模板复用-编辑态: 切换员工/客户/供应商→公共片段+扩展字段、提交
- [ ] Vue-动态表单-27.模板复用-阅读态+禁用态: 模板切换正常

### 复杂组件（Field模式）
- [ ] Vue-复杂组件-28.富文本编辑器-编辑态: 输入HTML内容、Textarea降级、提交
- [ ] Vue-复杂组件-28.富文本编辑器-阅读态: HTML预览、禁用态不可编辑
- [ ] Vue-复杂组件-29.文件上传-编辑态: 选择文件/图片、Upload组件交互、提交文件列表
- [ ] Vue-复杂组件-29.文件上传-阅读态+禁用态: 上传按钮隐藏
- [ ] Vue-复杂组件-30.地图选点-编辑态: 点击模拟地图选点、经纬度同步、地址更新
- [ ] Vue-复杂组件-30.地图选点-阅读态+禁用态: 地图不可点击
- [ ] Vue-复杂组件-31.颜色选择器-编辑态: 选择颜色、预设色板点击、HEX输入、主题预览区更新
- [ ] Vue-复杂组件-31.颜色选择器-阅读态: 色块+HEX展示、禁用态不可选
- [ ] Vue-复杂组件-32.代码编辑器-编辑态: 输入代码、语言切换、monospace字体
- [ ] Vue-复杂组件-32.代码编辑器-阅读态: 代码预览、禁用态不可编辑
- [ ] Vue-复杂组件-33.JSON编辑器-编辑态: 输入JSON、格式化/压缩、语法错误实时检测
- [ ] Vue-复杂组件-33.JSON编辑器-阅读态: JSON预览、禁用态不可编辑
- [ ] Vue-复杂组件-34.手写签名-编辑态: Canvas绘制签名、清空操作、签名数据同步
- [ ] Vue-复杂组件-34.手写签名-阅读态: 图片预览、禁用态不可绘制
- [ ] Vue-复杂组件-35.穿梭框-编辑态: 勾选权限→穿梭→搜索过滤、提交已选列表
- [ ] Vue-复杂组件-35.穿梭框-阅读态: Tag展示已选、禁用态穿梭不可操作
- [ ] Vue-复杂组件-36.树形选择-编辑态: 单选部门、多选可访问部门(treeCheckable)、提交
- [ ] Vue-复杂组件-36.树形选择-阅读态: Tag展示、禁用态不可选
- [ ] Vue-复杂组件-37.Markdown编辑器-编辑态: 左侧编辑+右侧实时预览、标题/加粗/列表渲染
- [ ] Vue-复杂组件-37.Markdown编辑器-阅读态: 纯预览、禁用态不可编辑
- [ ] Vue-复杂组件-38.图标选择器-编辑态: 搜索过滤图标、点击选中高亮、当前选中Tag显示
- [ ] Vue-复杂组件-38.图标选择器-阅读态+禁用态: 只显示选中图标
- [ ] Vue-复杂组件-39.Cron编辑器-编辑态: 输入Cron表达式、快捷预设点击、实时解析显示
- [ ] Vue-复杂组件-39.Cron编辑器-阅读态+禁用态: 解析结果显示

### 表单状态
- [ ] Vue-表单状态-40.数据转换-编辑态: format(分→元)/parse(元→分)/transform(逗号→数组)、原始值vs转换值对比
- [ ] Vue-表单状态-40.数据转换-阅读态+禁用态: 转换后值显示
- [ ] Vue-表单状态-41.多表单协作-编辑态: 主表单+子表单填写、弹窗表单联动、联合提交两个表单
- [ ] Vue-表单状态-41.多表单协作-阅读态+禁用态: 两表单只读
- [ ] Vue-表单状态-42.表单快照-编辑态: 填写→暂存草稿→修改→暂存第二版→恢复第一版→删除草稿
- [ ] Vue-表单状态-42.表单快照-阅读态+禁用态: 草稿列表可见但不可暂存
- [ ] Vue-表单状态-43.撤销重做-编辑态: 修改标题→修改分类→Ctrl+Z撤销→Ctrl+Shift+Z重做→历史记录计数
- [ ] Vue-表单状态-43.撤销重做-阅读态+禁用态: 撤销重做按钮禁用
- [ ] Vue-表单状态-44.生命周期-编辑态: 修改字段→事件日志记录onChange、提交→记录onSubmit、重置→记录onReset、自动保存
- [ ] Vue-表单状态-44.生命周期-阅读态+禁用态: 日志面板可见

### 其他能力
- [ ] Vue-其他能力-45.字段权限-编辑态: 切换管理员/经理/员工/访客→字段可见性+读写权限变化、权限矩阵正确
- [ ] Vue-其他能力-45.字段权限-阅读态+禁用态: 权限叠加正确
- [ ] Vue-其他能力-46.国际化-编辑态: 切换中/英/日→标签、placeholder、验证消息全部切换、提交按钮文本变化
- [ ] Vue-其他能力-46.国际化-阅读态+禁用态: 多语言标签正确
- [ ] Vue-其他能力-47.表单比对-编辑态: 修改字段→变更高亮(黄色背景)、原始值提示、变更摘要计数
- [ ] Vue-其他能力-47.表单比对-阅读态+禁用态: 高亮保持
- [ ] Vue-其他能力-48.打印导出-编辑态: 填写→打印(新窗口)→导出JSON(下载)→导出CSV(下载)
- [ ] Vue-其他能力-48.打印导出-阅读态+禁用态: 导出按钮可用

---

## React 测试

（Vue 测试完成后，按相同矩阵测试 React playground）

### 已完成
- [x] React-场景1-编辑态: 布局正常、必填校验生效、验证错误清除已修、onValuesChange已修
- [x] 全部48场景加载测试: 全部通过

---

## 发现的问题记录

| # | 问题 | 严重度 | 状态 | 修复提交 |
|---|---|---|---|---|
| 1 | Field.setValue()不清除验证错误 | P0 | 已修复 | 4afffa7 |
| 2 | Field.setValue()不通知form(reactions/onValuesChange不触发) | P0 | 已修复 | 4afffa7 |
| 3 | FormField创建字段时不继承form.pattern | P1 | 已修复 | 4afffa7 |
| 4 | @ant-design/icons依赖缺失 | P1 | 已修复 | 326da75 |
| 5 | field模式缺少重置按钮 | P2 | 已修复 | bb4e112 |
| 6 | ConfigForm不从schema.form读取pattern，阅读态/禁用态无效 | P0 | 已修复 | 待提交 |
| 7 | FormField不从field.pattern推导disabled/readOnly传给组件 | P0 | 已修复 | 待提交 |
| 8 | UI适配组件缺少readonly支持(Select/Radio/Switch/DatePicker等) | P1 | 已修复 | 待提交 |
| 9 | SchemaField不应用direction/layout CSS，布局切换无效果 | P0 | 已修复 | 待提交 |
| 10 | FormField不传递labelPosition给Wrapper，标签位置固定 | P1 | 已修复 | 待提交 |
| 11 | 阅读态组件仍显示为输入控件而非纯文本(PreviewText) | P1 | 已修复 | 待提交 |
| 12 | SchemaField过滤掉扁平化点路径字段(profile.name等不渲染) | P0 | 已修复 | 待提交 |
| 13 | FormField的fieldProps.name覆盖props.name导致嵌套路径丢失 | P0 | 已修复 | 待提交 |
